# Восстановленные файлы

Все файлы были восстановлены из исходного кода `РазборОперации_0058.txt`.

## Структура папок

- **ИсходныйКод/** - исходные версии функций и процедур
- **Оптимизированные/** - оптимизированные версии функций и процедур
- **Восстановлено/** - данная папка с информацией о восстановлении

## Восстановленные файлы

### ИсходныйКод/

1. `ОстаткиАктивовПоСделкамРЕПО_Исходный.bsl` - исходная функция
2. `ПолучитьОстаткиПоЕПС_Исходный.bsl` - исходная процедура
3. `ПолучитьДанныеАмортизации_Исходный.bsl` - исходная функция
4. `ЗаполнитьЦенныеБумаги_Исходный.bsl` - исходная процедура

### Оптимизированные/

1. `ОстаткиАктивовПоСделкамРЕПО_Оптимизированная.bsl` - оптимизированная функция с использованием временных таблиц
2. `ПолучитьОстаткиПоЕПС_Оптимизированная.bsl` - оптимизированная процедура с использованием ВЫБОР вместо СтрЗаменить
3. `ПолучитьДанныеАмортизации_Оптимизированная.bsl` - оптимизированная функция с использованием ТипЗначения.СодержитТип
4. `ЗаполнитьЦенныеБумаги_Оптимизированная.bsl` - заглушка для будущей оптимизации

## Основные оптимизации

### ОстаткиАктивовПоСделкамРЕПО

- Разбиение запроса на временные таблицы
- Получение остатков без условий по Субконто
- Передача МассивСубконто как третий параметр виртуальной таблицы
- Перемещение условий в второй запрос для JOIN

### ПолучитьОстаткиПоЕПС

- Использование ВЫБОР вместо СтрЗаменить
- Передача МассивСубконтоЕПС как третий параметр
- Упрощение логики с помощью флага ЛинейныйИлиАналогичныйМетод

### ПолучитьДанныеАмортизации

- Замена медленного метода ПринадлежитЭлементу() на ТипЗначения.СодержитТип()
- Использование ОбщегоНазначения.ЗначениеРеквизитаОбъекта() для безопасного чтения
- Избежание множественных запросов к БД для проверки иерархии
