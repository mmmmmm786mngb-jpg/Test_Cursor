# Полное правило работы с русской кодировкой и Office документами в Cursor

# Исключает кракозябры, обеспечивает корректную работу с Word/Excel

## ОСНОВНЫЕ ПРИНЦИПЫ

1. **ВСЕГДА** используй UTF-8 кодировку для всех файлов.
2. **НЕ ИСПОЛЬЗУЙ** русские символы в именах файлов для консольных команд.
3. **ПОМНИ:** Word и Excel — это заархивированные ZIP XML-файлы.
4. **ИСПОЛЬЗУЙ** Python скрипты для чтения и сборки Office документов.
5. **НАСТРАИВАЙ** консоль Windows на UTF-8 (`chcp 65001`) перед выполнением скриптов.
6. **ОБРАБАТЫВАЙ** ошибки кодировки, такие как `UnicodeEncodeError`.

## ПРАВИЛА ИМЕНОВАНИЯ ФАЙЛОВ

- Для файлов с русским содержимым используй английские имена.
- **Правильно:** `sentry_documentation.docx`, `monitoring_data.xlsx`
- **Неправильно:** `Документация_Sentry.docx`, `Данные_мониторинга.xlsx`

## РАБОТА С OFFICE ДОКУМЕНТАМИ

- **Техническая основа:** Word (`.docx`) и Excel (`.xlsx`) — это ZIP архивы с XML файлами внутри.
- **Для чтения:** Извлеки XML из ZIP-архива, затем парси содержимое.
- **Для создания:** Сформируй правильную XML структуру, затем упакуй в ZIP-архив с нужным расширением.
- **Ключевые файлы Word:** `word/document.xml`, `word/styles.xml`, `[Content_Types].xml`
- **Ключевые файлы Excel:** `xl/worksheets/sheet1.xml`, `xl/workbook.xml`, `xl/sharedStrings.xml`

## ЧТО НЕ ДЕЛАТЬ

- **НЕ** используй русские символы в именах файлов, с которыми работаешь из консоли.
- **НЕ** пытайся редактировать Office документы как обычные текстовые файлы.
- **НЕ** игнорируй структуру ZIP архива в Office документах.
- **НЕ** создавай текстовые/XML файлы без явного указания `encoding='utf-8'`.

## ПРОВЕРКА РАБОТОСПОСОБНОСТИ

- Файлы должны корректно открываться в Microsoft Word/Excel.
- Word/Excel документы должны содержать корректный русский текст без искажений.
- Все промежуточные XML/текстовые файлы должны быть в кодировке UTF-8.

## РЕЗУЛЬТАТ

- Никаких кракозябр в документах.
- Корректное программное создание и чтение Word/Excel файлов.
- Безопасные и предсказуемые операции с файлами.
- Полный контроль над структурой Office документов.
